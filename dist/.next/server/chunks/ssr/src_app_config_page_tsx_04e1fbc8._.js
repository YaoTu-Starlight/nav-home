module.exports=[15e3,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(5050),e=(0,d.createServerReference)("00fa0bbb402a4fea3b9960d0f7b8d9d628fc9524b9",d.callServer,void 0,d.findSourceMapURL,"getCategories"),f=(0,d.createServerReference)("600c1e55a67c1e4a50b2c33a0b4a78d375871c246d",d.callServer,void 0,d.findSourceMapURL,"addCategory"),g=(0,d.createServerReference)("408958feafa9094f471d2d6cb5f1417a41494adb3e",d.callServer,void 0,d.findSourceMapURL,"deleteCategory"),h=(0,d.createServerReference)("6048981fbcb7c601d09919745dc6faa2c90e8879ce",d.callServer,void 0,d.findSourceMapURL,"addSite"),i=(0,d.createServerReference)("6079a3b02bf4acd1ea43bbf4148ce8a7790ecffa3b",d.callServer,void 0,d.findSourceMapURL,"deleteSite"),j=(0,d.createServerReference)("40065bc5677d7898a0218afcd1686145a98b3e60de",d.callServer,void 0,d.findSourceMapURL,"uploadIcon"),k=(0,d.createServerReference)("00d49d2e4f06f48f2d54987e8ef9db00891bbb78f9",d.callServer,void 0,d.findSourceMapURL,"logout"),l=a.i(70106);let m=(0,l.default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),n=(0,l.default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),o=(0,l.default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);var p=a.i(96221);let q=(0,l.default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);var r=a.i(57064);let s=(0,l.default)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),t=(0,l.default)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),u=(0,l.default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var v=a.i(33508),w=a.i(71987);function x(){let[a,d]=(0,c.useState)([]),[l,x]=(0,c.useState)(!0),[y,z]=(0,c.useTransition)(),[A,B]=(0,c.useState)(""),[C,D]=(0,c.useState)(""),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(null),[I,J]=(0,c.useState)({name:"",url:"",desc:"",icon:"",tags:""}),[K,L]=(0,c.useState)(null);(0,c.useEffect)(()=>{M()},[]);let M=async()=>{try{let a=await e(),b=Array.isArray(a)?a:[];d(b),G&&!b.find(a=>a.id===G)&&H(null),b.length>0&&!G&&H(b[0].id)}catch(a){console.error("Fetch Data Error:",a),d([])}finally{x(!1)}},N=async(a,b)=>{let c=a.target.files?.[0];if(c){F(!0);try{let a=new FormData;a.append("file",c);let d=await j(a);d.success&&d.url?"category"===b?D(d.url):J({...I,icon:d.url}):alert("上传失败，可能是文件太大或权限不足")}catch(a){console.error(a),alert("上传出错")}F(!1)}},O=(a,c)=>a&&(a.startsWith("/")||a.startsWith("http"))?(0,b.jsx)("div",{className:"relative w-full h-full",children:(0,b.jsx)(w.default,{src:a,alt:"icon",fill:!0,className:"object-cover",sizes:"32px"})}):c;return l?(0,b.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,b.jsx)(p.Loader2,{className:"animate-spin text-blue-500",size:32})}):(0,b.jsxs)("div",{className:"min-h-screen p-6 text-slate-800 font-sans relative",children:[(0,b.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,b.jsxs)("header",{className:"mb-6 flex items-center justify-between border-b pb-4 border-white/30",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-slate-700",children:"后台管理"}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsxs)("button",{onClick:()=>k(),className:"px-4 py-2 bg-red-50 text-red-600 border border-red-200 rounded-lg hover:bg-red-100 text-sm flex items-center gap-2",children:[(0,b.jsx)(s,{size:16})," 退出"]}),(0,b.jsx)("a",{href:"/",className:"px-4 py-2 bg-white/80 border border-white rounded-lg text-sm hover:bg-white shadow-sm",children:"返回首页"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"bg-white/80 p-4 rounded-2xl border border-white/60 shadow-lg space-y-3",children:[(0,b.jsxs)("h2",{className:"font-semibold flex items-center gap-2 text-slate-700",children:[(0,b.jsx)(r.LayoutGrid,{size:18})," 新建分类"]}),(0,b.jsx)("input",{type:"text",placeholder:"名称",value:A,onChange:a=>B(a.target.value),className:"w-full px-3 py-2 rounded-lg bg-slate-50 border-none outline-none focus:ring-2 focus:ring-blue-100"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("input",{type:"text",placeholder:"图标URL",value:C,onChange:a=>D(a.target.value),className:"flex-1 px-3 py-2 rounded-lg bg-slate-50 border-none outline-none text-sm"}),(0,b.jsxs)("label",{className:"cursor-pointer p-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100",children:[E?(0,b.jsx)(p.Loader2,{size:18,className:"animate-spin"}):(0,b.jsx)(o,{size:18}),(0,b.jsx)("input",{type:"file",className:"hidden",accept:"image/*",onChange:a=>N(a,"category")})]})]}),C&&(C.startsWith("/")||C.startsWith("http"))&&(0,b.jsxs)("div",{className:"text-xs text-slate-400 flex items-center gap-2",children:["预览: ",(0,b.jsx)("div",{className:"relative w-6 h-6 rounded overflow-hidden border border-slate-200",children:(0,b.jsx)(w.default,{src:C,alt:"preview",fill:!0,className:"object-cover"})})]}),(0,b.jsx)("button",{onClick:()=>{if(!A)return alert("请输入分类名称");z(async()=>{try{let a=await f(A,C||"Folder");a.success?(B(""),D(""),await M()):alert("添加失败: "+(a.error||"未知错误"))}catch(a){console.error(a),alert("系统错误，请检查服务器日志")}})},disabled:y,className:"w-full py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center justify-center gap-2 text-sm shadow-md shadow-blue-200",children:y?"...":(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(n,{size:16})," 添加"]})})]}),(0,b.jsx)("div",{className:"space-y-2",children:a.map(a=>(0,b.jsxs)("div",{onClick:()=>H(a.id),className:`flex items-center justify-between p-3 rounded-xl cursor-pointer border transition-all ${G===a.id?"bg-white border-blue-200 text-blue-600 shadow-md":"bg-white/50 border-transparent hover:bg-white"}`,children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-6 h-6 rounded-md bg-slate-100 flex items-center justify-center overflow-hidden flex-shrink-0 text-slate-400",children:O(a.icon,(0,b.jsx)(r.LayoutGrid,{size:14}))}),(0,b.jsx)("span",{className:"font-medium truncate max-w-[120px]",children:a.title})]}),(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),L({type:"category",id:a.id})},className:"text-slate-400 hover:text-red-500",children:(0,b.jsx)(m,{size:16})})]},a.id))})]}),(0,b.jsx)("div",{className:"lg:col-span-2 space-y-6",children:G?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"bg-white/80 p-6 rounded-2xl border border-white/60 shadow-lg space-y-4",children:[(0,b.jsxs)("h2",{className:"font-semibold flex items-center gap-2 text-slate-700",children:[(0,b.jsx)(n,{size:18})," 添加站点"]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsx)("input",{type:"text",placeholder:"名称",value:I.name,onChange:a=>J({...I,name:a.target.value}),className:"px-3 py-2 rounded-lg bg-slate-50 border-none outline-none focus:ring-2 focus:ring-blue-100"}),(0,b.jsx)("input",{type:"text",placeholder:"链接",value:I.url,onChange:a=>J({...I,url:a.target.value}),className:"px-3 py-2 rounded-lg bg-slate-50 border-none outline-none focus:ring-2 focus:ring-blue-100"}),(0,b.jsx)("input",{type:"text",placeholder:"描述",value:I.desc,onChange:a=>J({...I,desc:a.target.value}),className:"px-3 py-2 rounded-lg bg-slate-50 border-none outline-none focus:ring-2 focus:ring-blue-100"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("input",{type:"text",placeholder:"图标",value:I.icon,onChange:a=>J({...I,icon:a.target.value}),className:"flex-1 px-3 py-2 rounded-lg bg-slate-50 border-none outline-none"}),(0,b.jsxs)("label",{className:"cursor-pointer p-2 bg-slate-100 text-slate-600 rounded-lg hover:bg-slate-200",children:[E?(0,b.jsx)(p.Loader2,{size:18,className:"animate-spin"}):(0,b.jsx)(q,{size:18}),(0,b.jsx)("input",{type:"file",className:"hidden",accept:"image/*",onChange:a=>N(a,"site")})]})]}),(0,b.jsx)("input",{type:"text",placeholder:"标签 (逗号分隔)",value:I.tags,onChange:a=>J({...I,tags:a.target.value}),className:"col-span-2 px-3 py-2 rounded-lg bg-slate-50 border-none outline-none focus:ring-2 focus:ring-blue-100"})]}),I.icon&&(I.icon.startsWith("/")||I.icon.startsWith("http"))&&(0,b.jsxs)("div",{className:"text-xs text-green-600 flex items-center gap-2 bg-green-50 px-3 py-1 rounded-full w-fit",children:["图标已就绪 ",(0,b.jsx)("div",{className:"relative w-4 h-4 rounded-full overflow-hidden border border-green-200",children:(0,b.jsx)(w.default,{src:I.icon,alt:"preview",fill:!0,className:"object-cover"})})]}),(0,b.jsx)("button",{onClick:()=>G?I.name&&I.url?void z(async()=>{try{let a=I.tags?I.tags.split(/[,，]/).map(a=>a.trim()).filter(Boolean):[],b=await h(G,{...I,tags:a});b.success?(J({name:"",url:"",desc:"",icon:"",tags:""}),await M()):alert("添加站点失败: "+(b.error||"可能是权限不足"))}catch(a){console.error(a),alert("添加出错，请F12查看控制台")}}):alert("必填项为空"):alert("请先选择分类"),disabled:y,className:"px-6 py-2 bg-slate-800 text-white rounded-lg ml-auto block text-sm shadow-lg hover:bg-slate-700",children:y?"...":"保存站点"})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:a.find(a=>a.id===G)?.items?.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white/60 rounded-xl border border-white/50 hover:bg-white transition-all group",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 overflow-hidden",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-lg bg-white border border-slate-100 flex items-center justify-center flex-shrink-0 overflow-hidden text-slate-300 shadow-sm",children:O(a.icon,(0,b.jsx)(t,{size:20}))}),(0,b.jsxs)("div",{className:"truncate pr-2",children:[(0,b.jsx)("h4",{className:"font-bold text-sm text-slate-700 group-hover:text-blue-600 transition-colors",children:a.name}),(0,b.jsx)("p",{className:"text-xs text-slate-400 truncate",children:a.url}),a.tags&&(0,b.jsx)("p",{className:"text-[10px] text-blue-500 mt-0.5 bg-blue-50 w-fit px-1.5 rounded",children:a.tags.join(", ")})]})]}),(0,b.jsx)("button",{onClick:()=>{L({type:"site",catId:G,index:c})},className:"p-2 text-slate-400 hover:text-red-500 opacity-60 group-hover:opacity-100",children:(0,b.jsx)(m,{size:16})})]},c))})]}):(0,b.jsx)("div",{className:"text-center p-12 text-slate-400 border-2 border-dashed border-white/30 rounded-2xl",children:"请选择分类"})})]})]}),K&&(0,b.jsxs)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/10 backdrop-blur-[2px] animate-in fade-in duration-300",onClick:()=>L(null)}),(0,b.jsxs)("div",{className:"relative w-full max-w-sm bg-white/30 dark:bg-slate-900/40 backdrop-blur-xl border border-white/50 dark:border-white/20 p-6 rounded-3xl shadow-2xl animate-in zoom-in-95 duration-200",children:[(0,b.jsxs)("div",{className:"flex flex-col items-center text-center gap-4",children:[(0,b.jsx)("div",{className:"w-12 h-12 rounded-full bg-red-500/10 text-red-500 flex items-center justify-center mb-1 border border-red-500/20",children:(0,b.jsx)(u,{size:28})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-slate-800 dark:text-slate-100",children:"确认删除？"}),(0,b.jsx)("p",{className:"text-sm text-slate-600 dark:text-slate-300 mt-2 font-medium",children:"category"===K.type?"删除分类将同时清空该分类下的所有站点，此操作无法撤销。":"您确定要删除此站点吗？"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3 w-full mt-4",children:[(0,b.jsx)("button",{onClick:()=>L(null),className:"py-2.5 rounded-xl bg-white/50 hover:bg-white/80 text-slate-700 font-medium transition-colors border border-white/20",children:"取消"}),(0,b.jsx)("button",{onClick:()=>{K&&z(async()=>{try{"category"===K.type?await g(K.id):await i(K.catId,K.index),await M(),L(null)}catch(a){console.error(a),alert("删除失败，请检查权限")}})},disabled:y,className:"py-2.5 rounded-xl bg-red-500/90 text-white font-medium hover:bg-red-600 shadow-lg shadow-red-500/20 transition-all flex items-center justify-center gap-2 backdrop-blur-sm",children:y?(0,b.jsx)(p.Loader2,{size:18,className:"animate-spin"}):"确认删除"})]})]}),(0,b.jsx)("button",{onClick:()=>L(null),className:"absolute top-4 right-4 text-slate-500/70 hover:text-slate-700 p-1 rounded-full hover:bg-white/20 transition-colors",children:(0,b.jsx)(v.X,{size:20})})]})]})]})}a.s(["default",()=>x],15e3)}];

//# sourceMappingURL=src_app_config_page_tsx_04e1fbc8._.js.map